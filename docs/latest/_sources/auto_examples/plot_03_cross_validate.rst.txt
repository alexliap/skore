
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_03_cross_validate.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_03_cross_validate.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_03_cross_validate.py:


.. _example_cross_validate:

==========================
Enhancing cross-validation
==========================

This example illustrates the motivation and the use of skore's
:func:`skore.cross_validate` to get assistance when developing your
ML/DS projects.

.. GENERATED FROM PYTHON SOURCE LINES 14-20

Creating and loading the skore project
======================================

We start by creating a temporary directory to store our project such that we can
easily clean it after executing this example. If you want to keep the project, you
have to skip this section.

.. GENERATED FROM PYTHON SOURCE LINES 22-32

.. code-block:: Python

    import tempfile
    from pathlib import Path

    import skore

    temp_dir = tempfile.TemporaryDirectory(prefix="skore_example_")
    temp_dir_path = Path(temp_dir.name)

    my_project = skore.create("my_project.skore", working_dir=temp_dir_path)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [11/20/24 15:37:26] <Logger skore.project.project (INFO)> Project  create.py:148
                                                              file                  
                                                              '/tmp/sk              
                                                              ore_exam              
                                                              ple_7ujr              
                                                              hqsa/my_              
                                                              project.              
                                                              skore'                
                                                              was                   
                                                              successf              
                                                              ully                  
                                                              created.              




.. GENERATED FROM PYTHON SOURCE LINES 33-51

Cross-validation in scikit-learn
================================

Scikit-learn holds two functions for cross-validation:

* :func:`sklearn.model_selection.cross_val_score`
* :func:`sklearn.model_selection.cross_validate`

Essentially, :func:`sklearn.model_selection.cross_val_score` runs cross-validation for
single metric evaluation, while :func:`sklearn.model_selection.cross_validate` runs
cross-validation with multiple metrics and can also return extra information such as
train scores, fit times, and score times.

Hence, in skore, we are more interested in the
:func:`sklearn.model_selection.cross_validate` function as it allows to do
more than the historical :func:`sklearn.model_selection.cross_val_score`.

Let us illustrate cross-validation on a multi-class classification task.

.. GENERATED FROM PYTHON SOURCE LINES 53-59

.. code-block:: Python

    from sklearn.datasets import load_iris
    from sklearn.svm import SVC

    X, y = load_iris(return_X_y=True)
    clf = SVC(kernel="linear", C=1, random_state=0)








.. GENERATED FROM PYTHON SOURCE LINES 60-61

Single metric evaluation using :func:`sklearn.model_selection.cross_validate`:

.. GENERATED FROM PYTHON SOURCE LINES 63-68

.. code-block:: Python

    from sklearn.model_selection import cross_validate as sklearn_cross_validate

    cv_results = sklearn_cross_validate(clf, X, y, cv=5)
    print(f"test_score: {cv_results['test_score']}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    test_score: [0.96666667 1.         0.96666667 0.96666667 1.        ]




.. GENERATED FROM PYTHON SOURCE LINES 69-70

Multiple metric evaluation using :func:`sklearn.model_selection.cross_validate`:

.. GENERATED FROM PYTHON SOURCE LINES 72-84

.. code-block:: Python

    import pandas as pd

    cv_results = sklearn_cross_validate(
        clf,
        X,
        y,
        cv=5,
        scoring=["accuracy", "precision_macro"],
    )
    test_scores = pd.DataFrame(cv_results)[["test_accuracy", "test_precision_macro"]]
    test_scores






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>test_accuracy</th>
          <th>test_precision_macro</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>1</th>
          <td>1.000000</td>
          <td>1.000000</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>4</th>
          <td>1.000000</td>
          <td>1.000000</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 85-103

In scikit-learn, why do we recommend using ``cross_validate`` over ``cross_val_score``?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Here, for the :class:`~sklearn.svm.SVC`, the default score is the accuracy.
If the users want other scores to better understand their model such as the
precision and the recall, they can specify it which is very convenient.
Otherwise, they would have to run several
:func:`sklearn.model_selection.cross_val_score` with different ``scoring``
parameters each time, which leads to more unnecessary compute.

Why do we recommend using skore's ``cross_validate`` over scikit-learn's?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In the example above, what if the users ran scikit-learn's
:func:`sklearn.model_selection.cross_validate` but forgot to manually add a
crucial score for their use case such as the recall?
They would have to re-run the whole cross-validation experiment by adding this
crucial score, which leads to more compute.

.. GENERATED FROM PYTHON SOURCE LINES 105-117

Cross-validation in skore
=========================

In order to assist its users when programming, skore has implemented a
:func:`skore.cross_validate` function that wraps scikit-learn's
:func:`sklearn.model_selection.cross_validate`, to provide more
context and facilitate the analysis.

Classification task
^^^^^^^^^^^^^^^^^^^

Let us continue with the same use case.

.. GENERATED FROM PYTHON SOURCE LINES 119-124

.. code-block:: Python

    cv_results = skore.cross_validate(clf, X, y, cv=5, project=my_project)

    fig_plotly_clf = my_project.get_item("cross_validation").plot
    fig_plotly_clf






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="e226868b-db01-4164-80b2-29075714df15" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e226868b-db01-4164-80b2-29075714df15")) {                    Plotly.newPlot(                        "e226868b-db01-4164-80b2-29075714df15",                        [{"hovertemplate":"%{y}","legendgroup":"group0","marker":{"color":"#636EFA"},"name":"test_score","showlegend":true,"visible":true,"x":[0,1,2,3,4],"y":[0.9666666666666667,1.0,0.9666666666666667,0.9666666666666667,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dash"},"mode":"lines","name":"Average test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9800000000000001,0.9800000000000001],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9982574185835056,0.9982574185835056],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9617425814164946,0.9617425814164946],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","marker":{"color":"#EF553B"},"name":"test_recall_weighted","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.9666666666666667,1.0,0.9666666666666667,0.9666666666666667,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dash"},"mode":"lines","name":"Average test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9800000000000001,0.9800000000000001],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9982574185835056,0.9982574185835056],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9617425814164946,0.9617425814164946],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","marker":{"color":"#00CC96"},"name":"test_precision_weighted","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.9696969696969696,1.0,0.9696969696969696,0.9696969696969696,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dash"},"mode":"lines","name":"Average test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9818181818181818,0.9818181818181818],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9984158350759141,0.9984158350759141],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9652205285604495,0.9652205285604495],"type":"scatter"},{"customdata":["0:00:00.000829","0:00:00.000849","0:00:00.000803","0:00:00.000842","0:00:00.000816"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","marker":{"color":"#AB63FA"},"name":"fit_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0008294582366943359,0.0008485317230224609,0.0008025169372558594,0.0008423328399658203,0.0008158683776855469],"type":"bar"},{"customdata":["0:00:00.000829","0:00:00.000849","0:00:00.000803","0:00:00.000842","0:00:00.000816"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dash"},"mode":"lines","name":"Average fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008277416229248047,0.0008277416229248047],"type":"scatter"},{"customdata":["0:00:00.000829","0:00:00.000849","0:00:00.000803","0:00:00.000842","0:00:00.000816"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008466184430969828,0.0008466184430969828],"type":"scatter"},{"customdata":["0:00:00.000829","0:00:00.000849","0:00:00.000803","0:00:00.000842","0:00:00.000816"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008088648027526267,0.0008088648027526267],"type":"scatter"},{"customdata":["0:00:00.002914","0:00:00.002770","0:00:00.002774","0:00:00.002769","0:00:00.002747"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","marker":{"color":"#FFA15A"},"name":"score_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0029144287109375,0.002769947052001953,0.0027740001678466797,0.0027692317962646484,0.0027472972869873047],"type":"bar"},{"customdata":["0:00:00.002914","0:00:00.002770","0:00:00.002774","0:00:00.002769","0:00:00.002747"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dash"},"mode":"lines","name":"Average score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.002794981002807617,0.002794981002807617],"type":"scatter"},{"customdata":["0:00:00.002914","0:00:00.002770","0:00:00.002774","0:00:00.002769","0:00:00.002747"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0028625668879799387,0.0028625668879799387],"type":"scatter"},{"customdata":["0:00:00.002914","0:00:00.002770","0:00:00.002774","0:00:00.002769","0:00:00.002747"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0027273951176352957,0.0027273951176352957],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Cross-validation results for each split"},"xaxis":{"dtick":1,"tickmode":"linear","title":{"text":"Split number"}},"yaxis":{"title":{"text":"Value"}}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 125-141

Skore's :func:`~skore.cross_validate` advantages are the following:

* By default, it computes several useful scores without the need for the user to
  manually specify them. For classification, you can observe that it computed the
  accuracy, the precision, and the recall.

* You automatically get some interactive Plotly graphs to better understand how your
  model behaves depending on the split. For example:

  * You can compare the fitting and scoring times together for each split.

  * You can compare the accuracy, precision, and recall scores together for each
    split.

* The results and plots are automatically saved in your skore project, so that you can
  visualize them later in the UI for example.

.. GENERATED FROM PYTHON SOURCE LINES 143-145

Regression task
^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 147-152

For now, all cross-validation runs store their results in the same place, which might
lead to comparing two different models that are actually not comparable (e.g.
comparing a regression with a classification).
To remedy this, we clear the cross-validation information stored in skore before
running another unrelated cross-validation:

.. GENERATED FROM PYTHON SOURCE LINES 154-157

.. code-block:: Python

    my_project.delete_item("cross_validation")
    my_project.delete_item("cross_validation_aggregated")








.. GENERATED FROM PYTHON SOURCE LINES 158-161

.. note::
  Soon, the storage of several unrelated cross-validation runs will be managed
  automatically.

.. GENERATED FROM PYTHON SOURCE LINES 163-176

.. code-block:: Python

    from sklearn.datasets import load_diabetes
    from sklearn.linear_model import Lasso

    diabetes = load_diabetes()
    X = diabetes.data[:150]
    y = diabetes.target[:150]
    lasso = Lasso()

    cv_results = skore.cross_validate(lasso, X, y, cv=5, project=my_project)

    fig_plotly_reg = my_project.get_item("cross_validation").plot
    fig_plotly_reg






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="39111c76-696e-48c5-83a4-627af9e58ff9" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("39111c76-696e-48c5-83a4-627af9e58ff9")) {                    Plotly.newPlot(                        "39111c76-696e-48c5-83a4-627af9e58ff9",                        [{"hovertemplate":"%{y}","legendgroup":"group0","marker":{"color":"#636EFA"},"name":"test_score","showlegend":true,"visible":true,"x":[0,1,2,3,4],"y":[0.2982867487756391,0.22414919618930618,0.15480127210175387,0.2551973269039568,0.1710871514478407],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dash"},"mode":"lines","name":"Average test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.22070433908369935,0.22070433908369935],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.27991950413745326,0.27991950413745326],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.16148917402994548,0.16148917402994548],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","marker":{"color":"#EF553B"},"name":"test_r2","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.2982867487756391,0.22414919618930618,0.15480127210175387,0.2551973269039568,0.1710871514478407],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dash"},"mode":"lines","name":"Average test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.22070433908369935,0.22070433908369935],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.27991950413745326,0.27991950413745326],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.16148917402994548,0.16148917402994548],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","marker":{"color":"#00CC96"},"name":"test_neg_root_mean_squared_error","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[-52.98271412620445,-69.93123859116155,-57.97111409545601,-68.286418279226,-71.77966037436696],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dash"},"mode":"lines","name":"Average test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-64.19022909328298,-64.19022909328298],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-55.949731441964374,-55.949731441964374],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-72.43072674460159,-72.43072674460159],"type":"scatter"},{"customdata":["0:00:00.000765","0:00:00.000607","0:00:00.000627","0:00:00.000600","0:00:00.000597"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","marker":{"color":"#AB63FA"},"name":"fit_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0007646083831787109,0.0006074905395507812,0.0006268024444580078,0.0006003379821777344,0.0005974769592285156],"type":"bar"},{"customdata":["0:00:00.000765","0:00:00.000607","0:00:00.000627","0:00:00.000600","0:00:00.000597"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dash"},"mode":"lines","name":"Average fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.00063934326171875,0.00063934326171875],"type":"scatter"},{"customdata":["0:00:00.000765","0:00:00.000607","0:00:00.000627","0:00:00.000600","0:00:00.000597"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0007102964465974651,0.0007102964465974651],"type":"scatter"},{"customdata":["0:00:00.000765","0:00:00.000607","0:00:00.000627","0:00:00.000600","0:00:00.000597"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0005683900768400349,0.0005683900768400349],"type":"scatter"},{"customdata":["0:00:00.001233","0:00:00.001117","0:00:00.001105","0:00:00.001102","0:00:00.001141"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","marker":{"color":"#FFA15A"},"name":"score_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0012326240539550781,0.0011169910430908203,0.0011048316955566406,0.0011019706726074219,0.0011413097381591797],"type":"bar"},{"customdata":["0:00:00.001233","0:00:00.001117","0:00:00.001105","0:00:00.001102","0:00:00.001141"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dash"},"mode":"lines","name":"Average score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0011395454406738282,0.0011395454406738282],"type":"scatter"},{"customdata":["0:00:00.001233","0:00:00.001117","0:00:00.001105","0:00:00.001102","0:00:00.001141"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.001193841732309664,0.001193841732309664],"type":"scatter"},{"customdata":["0:00:00.001233","0:00:00.001117","0:00:00.001105","0:00:00.001102","0:00:00.001141"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0010852491490379924,0.0010852491490379924],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Cross-validation results for each split"},"xaxis":{"dtick":1,"tickmode":"linear","title":{"text":"Split number"}},"yaxis":{"title":{"text":"Value"}}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 177-180

.. seealso::
  For tracking and comparing several runs of cross-validations on the same data, see
  :ref:`example_track_cv`.

.. GENERATED FROM PYTHON SOURCE LINES 182-186

Cleanup the project
-------------------

Remove the temporary directory:

.. GENERATED FROM PYTHON SOURCE LINES 186-187

.. code-block:: Python

    temp_dir.cleanup()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.157 seconds)


.. _sphx_glr_download_auto_examples_plot_03_cross_validate.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_03_cross_validate.ipynb <plot_03_cross_validate.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_03_cross_validate.py <plot_03_cross_validate.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_03_cross_validate.zip <plot_03_cross_validate.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
